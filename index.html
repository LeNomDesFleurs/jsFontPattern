
<html>



    <head>

        <style>
        .controller {
            position: absolute;
            background: rgb(144, 131, 131);
            opacity: 0.8;
            top: 2rem;
            right: 0.0rem;
            /* left: 0.1rem; */
            display: flex;
            flex-direction: column;
            padding: 1rem;
            border-radius: 1em;
            }

        .models-container {
            position: absolute;
            top: 0;
            width: auto;
            height: 30px;
            display: flex;
            background-color: rgb(0, 0, 0, 0);
        }
        </style>
    </head>
    <body>

<div class="controller">
    <label for="slider_wght">sin</label>
    <input type="range" id="slider_wght" min="0" max="100" step="0.1" value="2">
    <span id="value_wght"></span>
    <!-- <p></p> -->
    <label for="margin">margin</label>
    <input type="range" id="margin" min="0" max="1" step="0.01" value="0">
    <span id="margin"></span>
    
    <label for="lettersize">lettersize</label>
    <input type="range" id="lettersize" min="10" max="100" step="1" value="20">
    <span id="lettersize"></span>
    
    <label for="gap">gap</label>
    <input type="range" id="gap" min="0.5" max="10" step="0.01" value="1">
    <span id="gap"></span>
</div>

        

    <!-- <canvas height="800" id="c" width="800"></canvas> -->
    <script>
// Source - https://stackoverflow.com/a
// Posted by toastrackengima, modified by community. See post 'Timeline' for change history
// Retrieved 2025-12-01, License - CC BY-SA 4.0

// TODO add slider
// TODO add a way to hide / show the sliders with a keyboard command
// TODO add a way to save the canvas


function createHiPPICanvas(width, height) {
    const ratio = window.devicePixelRatio;
    const canvas = document.createElement("canvas");

    canvas.width = width * ratio;
    canvas.height = height * ratio;
    canvas.style.width = width + "px";
    canvas.style.height = height + "px";
    canvas.getContext("2d").scale(ratio, ratio);

    return canvas;
}

function dist(ax, ay, bx, by){
    var a = ax - bx;
var b = ay - by;
var c = Math.hypot(a,b)
return c;
}

function generate(){
    // TODO make dynamic
var width = window.innerWidth;
var height = window.innerHeight;

var canvas = createHiPPICanvas(width, height);
if (document.body.hasChildNodes()) {
    document.body.removeChild(document.body.lastElementChild);
}
document.body.appendChild(canvas);

var ctx = canvas.getContext("2d")
// ctx.fillStyle = "black";
// ctx.textAlign = 'right';

var string = "WHAT?";
var lenght = string.length;

ctx.font = "20px sans-serif";
lettersize = document.getElementById("lettersize").value;
// lettersize = number(lettersize);
ctx.font = `${lettersize}px sans-serif`;
gap = document.getElementById("gap").value * lettersize;
for (var i = 1; i<(height/gap); i = i+1){
    index = i;
    let sint = document.getElementById("slider_wght").value;
    half = Math.floor((height/gap)/2.);
    if (index > half) {index = half - index % half;}
    margin_coef = document.getElementById("margin").value
    margin = ((Math.sin(index/half * sint)+1) * 100)*margin_coef;
    // (height/gap) - (i % ((height/gap)/2));

    for (var s = 0; s<((lenght*index)); s = s+1){
        console.log(index)
        w = margin+(((width-(margin*2)) / ((lenght*index)-1))*s);
        h = gap*i;
        var pointx = width/2;
        var pointy = height/2;
        var distance = dist (w, h, pointx, pointy)/3;
        var distx = 20*Math.log((1-((pointx-w)/pointx)));
        // console.log(distx)
        var disty = 20*Math.log((1-((pointy-h)/pointy)));
        ctx.fillText(string[s%lenght], w, h);
    }
    // ctx.fillText(string[lenght-1], (width - 30), gap*i);

    //TODO general offset / wave / gravity

}
}

generate()
window.addEventListener("resize", generate);
document.getElementById("slider_wght").addEventListener("input", generate);
document.getElementById("margin").addEventListener("input", generate);
document.getElementById("lettersize").addEventListener("input", generate);
document.getElementById("gap").addEventListener("input", generate);

 

// ctx.font = "bold italic 50px Arial";
// // ctx.font = "50px Arial";
// ctx.fillText("Hello World",10,80);

// ctx.font = "50px Arial";
// ctx.strokeText("Hello World",10,80);
// console.log(canvas)

//TODO size problem on image conversion
// var img    = canvas.toDataURL("image/png");
//     document.write('<img src="'+img+'"/>');

</script> 

<!-- <script src="picture.js"></script> -->
</body>
</html>